#!/usr/bin/env python3
"""
webhook_tester.py - Send a benign JSON/post to webhook URLs for testing

Example:
  python3 scripts/exploitation/webhook_tester.py --url https://hooks.example.com/abc --data '{"ok":1}'
"""
from __future__ import annotations
import argparse
import json
import sys
try:
    import requests
except Exception:
    requests = None

GREEN = "\033[1;32m"
YELLOW = "\033[1;33m"
RED = "\033[1;31m"
NC = "\033[0m"


def main() -> int:
    p = argparse.ArgumentParser(description='Webhook tester (benign POST)')
    p.add_argument('--url', required=True)
    p.add_argument('--data', default='{"ping":1}')
    args = p.parse_args()

    if requests is None:
        print(f"{RED}[!] requests not installed. Install with: pip install requests{NC}", flush=True)
        return 2

    try:
        payload = json.loads(args.data)
    except Exception:
        payload = {"data": args.data}

    try:
        r = requests.post(args.url, json=payload, timeout=8)
        print(f"{GREEN}Status:{NC} {r.status_code} {r.reason}", flush=True)
        print(f"{YELLOW}Response (truncated):{NC}\n{r.text[:1000]}", flush=True)
    except Exception as e:
        print(f"{RED}[!] Error sending webhook:{NC} {e}", flush=True)
        return 2

    return 0


if __name__ == '__main__':
    sys.exit(main())
